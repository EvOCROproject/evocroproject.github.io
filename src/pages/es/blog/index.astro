---
import {
  Container,
  TextCardSection,
  BlogPostsList,
} from '@components/odyssey-theme';
import Layout from '../../../layouts/Page.astro';

const rawPosts = await Astro.glob('./posts/*.mdx');

const posts = rawPosts
  .map(({ frontmatter, url }) => ({
    title: frontmatter.title,
    description: frontmatter.description,
    authors: frontmatter.authors,
    publishDate: new Date(frontmatter.publishDate),
    featuredImage: frontmatter.featuredImage,
    excerpt: frontmatter.excerpt,
    tags: frontmatter.tags ?? [],
    href: url,
  }))
  .sort((a, b) => b.publishDate.getTime() - a.publishDate.getTime());

const seo = {
  title: 'Blog | EvOCRO',
  description: 'Artículos y novedades del proyecto EvOCRO.',
};
---

<Layout {seo}>
  <Container>
    <TextCardSection>
      <div class="lang-switcher">
        <a href="/blog">EN</a>
        <a href="/it/blog">IT</a>
        <a href="/es/blog" class="active">ES</a>
        
      </div>

      <h1>Blog</h1>
      <p>Artículos y novedades del proyecto EvOCRO.</p>
    </TextCardSection>

    <section class="blog-posts-list__section">
      <h2>Entradas recientes</h2>
      <BlogPostsList posts={posts} />
    </section>
  </Container>
</Layout>

<style>
  /* Sezione elenco post: sempre in lettura LTR e testo a sinistra */
  .blog-posts-list__section {
    margin: var(--section-margin) auto;
    direction: ltr !important;
    text-align: left !important;
  }

  /* Lista dei post: griglia che parte da sinistra e non viene “spinta” */
  .blog-posts-list__list {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 2rem;

    direction: ltr !important;
    justify-content: flex-start !important;
    justify-items: stretch !important;
    margin-left: 0 !important;
    margin-right: 0 !important;
    padding-left: 0 !important;
    padding-right: 0 !important;
  }

  /* Singola anteprima: niente auto-margin strani, testo a sinistra */
  .blog-post__preview,
  .blog-post__preview a {
    direction: ltr !important;
    text-align: left !important;
    margin: 0 !important;
  }

  /* Switcher delle lingue: resta a destra come prima */
  .lang-switcher {
    display: flex;
    justify-content: flex-end;
    gap: 0.5rem;
    margin-bottom: 0.75rem;
  }

  .lang-switcher a {
    padding: 0.25rem 0.75rem;
    border-radius: 999px;
    border: 1px solid var(--theme-on-surface-2);
    font-size: var(--font-size-sm);
    text-decoration: none;
  }

  .lang-switcher a.active {
    background: var(--theme-primary);
    color: var(--theme-on-primary);
  }
</style>
