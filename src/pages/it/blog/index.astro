---
import {
  Container,
  TextCardSection,
  BlogPostsList,
} from '@components/odyssey-theme';
import Layout from '../../../layouts/Page.astro';

const rawPosts = await Astro.glob('./posts/*.mdx');

const posts = rawPosts
  .map(({ frontmatter, url }) => ({
    title: frontmatter.title,
    description: frontmatter.description,
    authors: frontmatter.authors,
    publishDate: new Date(frontmatter.publishDate),
    featuredImage: frontmatter.featuredImage,
    excerpt: frontmatter.excerpt,
    tags: frontmatter.tags ?? [],
    href: url,
  }))
  .sort((a, b) => b.publishDate.getTime() - a.publishDate.getTime());

const seo = {
  title: 'Blog | EvOCRO',
  description: 'Articoli e aggiornamenti dal progetto EvOCRO.',
};
---

<Layout {seo}>
  <Container>
    <TextCardSection>
      <div class="lang-switcher">
        <a href="/it/blog">EN</a>
        <a href="/blog" class="active">IT</a>
        <a href="/es/blog">ES</a>
      </div>

      <h1>Blog</h1>
      <p>Articoli e aggiornamenti dal progetto EvOCRO.</p>
    </TextCardSection>

    <section class="blog-posts-list__section">
      <h2>Articoli recenti</h2>
      <BlogPostsList posts={posts} />
    </section>
  </Container>
</Layout>

<style>
  .blog-posts-list__section {
    margin: var(--section-margin) auto;
  }

  .lang-switcher {
    display: flex;
    justify-content: flex-end;
    gap: 0.5rem;
    margin-bottom: 0.75rem;
  }

  .lang-switcher a {
    padding: 0.25rem 0.75rem;
    border-radius: 999px;
    border: 1px solid var(--theme-on-surface-2);
    font-size: var(--font-size-sm);
    text-decoration: none;
  }

  .lang-switcher a.active {
    background: var(--theme-primary);
    color: var(--theme-on-primary);
  }
</style>
